# コンパイラに渡すオプションを指定
CFLAGS=-std=c11 -g -static
# wildcardはmakeが提供する関数 マッチするファイル名に展開
SRCS=$(wildcard *.c)
# 右辺は変数の置換ルールを使用　.cを.oに置き換えている
OBJS=$(SRCS:.c=.o)

# デフォルトでは一番上に書いてあるターゲットが実行される.
# 9ccファイルを作成することが最終的な目標.
9cc: $(OBJS)
	$(CC) -o 9cc $(OBJS) $(LDFLAGS)

# 全てのファイルが9cc.hに依存していることを表す
# つまり、9cc.hを変更すると全部のファイルが再コンパイルされるということ
$(OBJS): 9cc.h

test: 9cc 
	./test.sh

clean: 
	rm -f 9cc *.o *~ tmp*

# .PHONY ${ターゲット名} という記載で、
# そのターゲットは、ファイルは生成しないという事を make に知らせることができる

# タスクの名前でネーミングしたターゲットが、実はファイルやディレクトリとして存在
# している場合、コマンドが実行されないことになってしまう。そのため、ターゲットが
# ファイルではなく、擬似的な名前のターゲットであることを明示するためにPHONYがある
.PHONY: test clean